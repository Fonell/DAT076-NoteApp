<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" 
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core">
 
     <h:head>
        <title>Start Page</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"></meta>
            <h:outputStylesheet name="primeicons/primeicons.css" library="primefaces"/>
        
            <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"></link>
            <link rel="stylesheet" href="darkmode.css"></link>
     </h:head>
 
     <h:body>

         <div class="header">
            <div class="header-container">
                <p:commandLink class="pi pi-bars" style="font-size: 2rem; color: white; text-decoration: none" rendered="#{userBean.loggedIn}" onclick="PF('sidebar1').show()" />
            </div>
            <div class="header-container">
                <p:commandLink class="pi pi-plus-circle" style="font-size: 2rem; color: white; text-decoration: none" update="mainForm" oncomplete="PF('addEventDialog').show()" title="View"/>
            </div>
        </div>
        
        <p:sidebar widgetVar="sidebar1" baseZIndex="10000">
            <h3 style="center"> NoteApp. </h3>           
            <div>
                <p:commandLink style="menu-button" value="Folders"/>
                <p:commandLink style="menu-button" value="Notes"/>
                <p:commandLink style="menu-button" value="Settings"/>
                <p:separator />
                <p:commandLink style="menu-button" action="#{loginControllerBean.onLogout}" value="Logout"/>
            </div>
        </p:sidebar>
                           
        
        <div class="main-content">
            <p class="large-title" align="center">March</p>
            <h:form id="mainForm">
                <p:repeat id="noteDT" var="note" value="#{noteBackingBean.notes}">
                    <div class="big-card">
                        <div class="basic-grid">
                            <div class="card">
                                <p>#{note.name}</p>

                                <div>

                                    <p:commandLink action="#{noteBackingBean.deleteNote}" class="pi pi-trash" style="font-size: 2rem; color: white; text-decoration: none" update="mainForm" process="@this" title="Delete">                
                                        <f:setPropertyActionListener target="#{noteBackingBean.selectedNote}" value="#{note}" />
                                    </p:commandLink>

                                    <p:commandLink class="pi pi-external-link" style="font-size: 2rem; color: white; text-decoration: none" update="noteDetail" onclick="PF('viewEventDialog').show()">                
                                        <f:setPropertyActionListener target="#{noteBackingBean.selectedNote}" value="#{note}" />
                                        <f:setPropertyActionListener target="#{noteBackingBean.noteText}" value="#{note.text}" />
                                    </p:commandLink>
                                    
                                </div> 
                            </div>
                        </div>
                    </div>
                </p:repeat>
            </h:form>
        </div>
         
         
    <p:dialog header="Add event" widgetVar="addEventDialog" modal="false" draggable="false" resizable="false" responsive="true" closeOnEscape="true">
        <h:form>
            <p:panelGrid id="formPanel" columns="2">
                <p:outputLabel for="noteName" value="Name"/>
                <p:inputText id="noteName" value="#{noteBackingBean.noteName}" autocomplete="off"/>
                <p:outputLabel for="noteText" value="Text"/>
                <p:inputText id="noteText" value="#{noteBackingBean.noteText}" autocomplete="off"/>
                <p:outputLabel for="buttonbar" value="Date"/>
                <p:datePicker id="buttonbar" showButtonBar="true" autocomplete="off"/>
                <p:outputLabel for="timeonly" value="Time"/>
                <p:datePicker id="timeonly" value="#{noteBackingBean.noteDate}" timeOnly="true" pattern="HH:mm" autocomplete="off"/>
            </p:panelGrid>
            <div class="button-footer">
                <p:commandButton styleClass="customButton" value="Add" action="#{noteBackingBean.createNote}" update="mainForm" process="@form" oncomplete="PF('addEventDialog').hide();"/>
                <p:commandButton styleClass="customButton" value="Reset">
                    <p:ajax update="formPanel" resetValues="true"/>
                </p:commandButton>
            </div>
        </h:form>
    </p:dialog>
         
    <p:dialog header="Note" widgetVar="viewEventDialog" modal="true" draggable="false" resizable="true" responsive="true" closeOnEscape="true" height="100" minHeight="100">
        <p:outputPanel id="noteDetail">
            <h:form>
                <p:inplace editor="true">
                    <p:inputText value="#{noteBackingBean.selectedNote.text}" required="true" label="text" />
                </p:inplace>             
            </h:form>
        </p:outputPanel>
    </p:dialog>
                    
    </h:body>
</html>